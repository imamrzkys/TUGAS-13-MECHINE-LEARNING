{% extends "base.html" %}

{% block title %}Visualisasi Data - Fraud Detection SVM{% endblock %}

{% block content %}
<section class="visualizations-section">
    <div class="container">
        <div class="page-header">
            <h1 class="page-title">Visualisasi Data</h1>
            <p class="page-subtitle">Eksplorasi visual dari dataset dan performa model <strong>Machine Learning</strong></p>
        </div>
        
        {% if plots %}
        <div class="visualizations-grid">
            {% for plot in plots %}
            <div class="visualization-card glass-card" data-aos="fade-up" data-aos-delay="{{ loop.index0 * 100 }}">
                <div class="viz-image-container" onclick="openModal('{{ url_for('static', filename=plot.path) }}', '{{ plot.caption }}')">
                    <img src="{{ url_for('static', filename=plot.path) }}" alt="{{ plot.caption }}" class="viz-image">
                    <div class="viz-overlay">
                        <svg class="zoom-icon" width="48" height="48" viewBox="0 0 48 48" fill="none">
                            <circle cx="20" cy="20" r="10" stroke="white" stroke-width="2"/>
                            <path d="M28 28L36 36" stroke="white" stroke-width="2" stroke-linecap="round"/>
                            <path d="M20 16V24M16 20H24" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        <span class="zoom-text">Klik untuk memperbesar</span>
                    </div>
                </div>
                <div class="viz-caption">
                    <h3 class="viz-title">{{ plot.caption }}</h3>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="empty-state glass-card">
            <div class="empty-icon">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none">
                    <rect x="15" y="15" width="50" height="50" rx="4" stroke="url(#emptyGrad)" stroke-width="2"/>
                    <path d="M30 35L40 45L50 30" stroke="url(#emptyGrad)" stroke-width="2" stroke-linecap="round"/>
                    <defs>
                        <linearGradient id="emptyGrad" x1="0" y1="0" x2="80" y2="80">
                            <stop offset="0%" stop-color="#00e5ff"/>
                            <stop offset="100%" stop-color="#00b8cc"/>
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <h2 class="empty-title">Belum Ada Visualisasi</h2>
            <p class="empty-text">
                Visualisasi akan muncul di sini setelah Anda menambahkan file gambar ke folder <code>static/plots/</code>
            </p>
        </div>
        {% endif %}
    </div>
</section>

<div id="imageModal" class="modal" onclick="closeModal()">
    <span class="modal-close">&times;</span>
    <div class="modal-content" onclick="event.stopPropagation()">
        <img id="modalImage" src="" alt="">
        <div id="modalCaption" class="modal-caption"></div>
    </div>
</div>

{% block extra_js %}
<script>
function openModal(imageSrc, caption) {
    const modal = document.getElementById('imageModal');
    const modalImg = document.getElementById('modalImage');
    const modalCaption = document.getElementById('modalCaption');
    
    modal.style.display = 'flex';
    modalImg.src = imageSrc;
    modalCaption.textContent = caption;
    
    setTimeout(() => {
        modal.classList.add('active');
    }, 10);
    
    document.body.style.overflow = 'hidden';
}

function closeModal() {
    const modal = document.getElementById('imageModal');
    modal.classList.remove('active');
    
    setTimeout(() => {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
    }, 300);
}

document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeModal();
    }
});

const vizCards = document.querySelectorAll('.visualization-card');
vizCards.forEach((card, index) => {
    setTimeout(() => {
        card.classList.add('fade-in');
    }, index * 100);
});
</script>
{% endblock %}
{% endblock %}
